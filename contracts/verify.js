const { ml_dsa65 } = await import("npm:@noble/post-quantum/ml-dsa.js")

//args[0]: public key, as hex encoded string
//args[1]: msg, as hex encoded string (?)
//args[2]: sig, as hex encoded string

// test values
var _publicKey = "5c154ce82effd30445d85a99a89effa99436585572cb2292a5c35fb6d628cac1d1eb61743c0134d0d3be9c9d03f375707141adc839095b3e9be8a2cd15b47aa61a18b89b6fd81e22547f77d5cdfadf32726ab1f9758f8242f69186e1f5cf053661e4e235b7ba76978ebbdd602f5c01dc4b08f72190c8cbd195ca5df30de98b33d218afb49407a78eee2c0d208858c20baec610ed267eac9889765bbabb509d5920626f25b2f2895e8b1edd4abe863ed9bda87cad9dd950daf058b44033896978b6bdda8ebcee23349c2e3060e954dd5d90bcfbd930fa274f373dcfba2431909ee6fe41b32974af7e06b10eb2a11c586f12f593d81fe47c843ca78c7eb3fcc34dfa33220f2c3ef79273fc1cce47674c4a0c8b1e185d1e3d5bcd2573549d65adbf2f7b7861a956ac822ceab6413df479b1580a5fe9819a3dd57b52405fc1a0cb6331abbd75f957dd906eb9037f7244b7002313c43b8afdf074e5af133e8075e7bc9677c1653acfdf5d0f88edc330570d3f1a4213201c852638b7c52c5fc93679ca735364e27118d9e4997e4e21b8474a99ec5fe515efab986c54151f2869fb4b379e5985a6aaca4838c66a7446a540430090467897e75117c29966f6a74eb0cd5a075fa3726a9dbb1a6359d54f371837d8b37c5a4666ba303686e1f5a34ce5fc08b7f1a4e61a0519e53696945457405d65d31e1ad822e5322a068d55596e554833428bffb2ef38a1ab2b67d2b53d9461c370508ec8394e4f7668031c1cf66ca1e31728427c39c606920ae1e87293989cef87b986c9fc190be5ac5b89d32078cab615c130dac69640ecb9c8e7acbded59008711e257a861ca3c958413dd9033818dd66da3be3ecdb2dc90ded47284ee24b2e0f956e2eda736daa17952dca3cee2c7d7a1b7db26faa3ead90abb834717e86eed133b4f535f09bed279f7608e3a6bd08e348f9c72b55df469c29ed461e23b3cd34c8c0186435329c6ddcafd6694d432946e1025433e5426085313236f379e68dfdf4fd5cb43f8fbbbc0acf68f581d8ddc8dae756bd45ad66386ad19c696dacb621aa91d23524076e4522653ac6f970bd98a8c7730d07087e0b870fa99b8545116ab3c583604db49f9626e26b5d2ff049b0854f4d38d790afa3dbd1c2cc50c1861ff0a6d62fdbe32fae1c61dd9d423012ee80496bbed5595d7419cac8a304b47e743a4d43430acf0271fe8159c63e662b4a4827a3e627272a44bdb8fde15fe31718c2dd290bdd46b2827921e532d24d7305c5f8c851b861d2564c6859ef0d26b8d7f808c7d7b6749814313504b50075acf087b4fb32b55bc0a0f5123cf4256303ab0e9215a9cc76a7d447d71bbbd01aec85ab4314fdae78b53d962b2e273577d171d0ee61ce8f9bcc7e7ccbbbbfef5f7391c63b335e5d7b3f501a58122bad8cd15853e4a4d68b18ca1dbde43d27c1316e9a215cb02cd541de85dc6a339ab195a325f15ce038e5adba3bd2b6fda2227f5d5a91619820d5ea30dbe2f37a2aced0905e7a873285a72367936c46a699f4e3834181f4b87b3c10ed70448e2c6211c6387339d5472d604e3b22dda19bf59eb57f61a22cf567154ed88a3fe736fcc1b38ec94f3570f23b2b2ccaf8fd51b282af6a6305f396e9bb52d28e89f191c10064301eae195475b1014256e435cd4be15add8d0f9a4774709f1361e8f8de2d211f7c9012fea80ea4bcd0784f36bd1e28918f652a099ca513924fb5022948ec921f9bd9a6a122b02674906edfc96dd0f50fbb032e7526730884ac08767fae7287951e1ed876fef5aced23becb29d96091832d5e18c271055efca0da28a4efd6712c4de2c1a35fa5ec5ba7e50bcc607cdb69e52ad5f779afcfa983f201b3763b7121269fe1dc14792efe72d774b02415a20e762de3478a49a8799717ea4fd48725575ced4983006e5142a2787e61d1b53f5b6755264ece17f0bdca535e98aa9d31c1fa82b03f4ae8975fa48447f094d7ca68cbca1f7a1e9a5355e98db273ac1ebd87fe873a311a3ee9de68cf2db81c37ba5b036456a3108d575bc673e02e6e352a5f181da0221996878da840c9482fb2480b398fe36b72298443beba6143fc1e51c20f618816d9f52e861b2ef67c2ce6a8706f6bb26a79dbf9b03014415ef003c5fd4897c6b401e31ede0f0cdbc518972e06e9e9a96073d92c4f68d86cdc65d6dac33f99d31916f3d720d4d240bb2545419d5261339e86f724aabc143ed4297303608c638770d111e5ed05f98a699d59c71d30eca28d572a24bdf25363c27fed51b903b49cc3d05e3dffc21fa1f8339c31d2dbf8413aaf6368da6466135784e910bb4d9831b5f8487d6af3217b4c71477bbf59927f11046f2d5bd49d83b23ba5ac9a9f248b8f5bf6899e98cea0b14b04794fdaacce3fab3a5857f7973c448df3cc33fb1e2fba1a2468d48c7abfa45116affaf626044d5f38a9a123fc9b105e08a3989114926eb899d6fc22cea4f712870cc8df8515bb8eec3bfcabd3f2b3bd79cbd75bcb367bd494d138177c6cd1edf28b593c50e49d306afc3c59969a51fd974db987eecae11665053574faf2c3b110a9b806392683a28cb832284c52340f94a5287696a2c81c820fec804c7d743691d973914f4af6f8b14c636d992c6f9aaf667049754dd7ac3aab4c2f1467d7ee9e99993b626e96b16d4bdff43cf825e94cde69ebd626bf638542d396dfe19590ed1e4e01f770cede3e3a8d9638e061ed2d5392e0421dd70f5b689f489e61c64c06a391a"
var _msg = "68656c6c6f206e6f626c65"
var _sig = "c814505398722552d5de7472b50ba7ca41f824d22df945b17394a9c45d9231dc3c3460764e40e784d68d77ac68d1bf8f960c2831acd8ed754c7cfa98bd32560b11b50286587effa12a758ca8e23700d3687acdf9b91e8bd4d1f2b050d099a1b51172ac08b55cccd9fc7e7dd3a9783667b822d5c86fabfc80c7d992a639fab7fecc88c367965bd81388182a15cb52cf7cca343b49c4ed1eb44997c2292c5aceaa62351ec6ad730ba4377b7ea96acb0ce976569d460d82d0f74eecc93a88a3ca69e6e27395748b72f29c749a96d2c2b6179a0dd347afbfa325bb1f8b4dc4c30c630a1fd4312552f362c25f4b8d6a22e2c74b86e3ab7c6ffa2f880e476a715b93b4424339da547f043ac4ab5b6f5230ba49fa493d5607da3b1f638118e1d2c1e4d76316a68bdcd4ed4a23b2592777babcc3df6641e8ff34f7d294d01349fca2c31aef4b960df096235bc2cb9f14968706bdb12ed53bb68dbc6358c0574a06e987456efaad3354887d28105d6e2ed5e682f769ee0be837eaa5c70c4fc52e1e4cb23c83abac881d5ff9e29a584090b01c325e20958b48f56ba99aa6d4898fa0218e0824349690a7b1a5b81ba8f05f9acebccc028ffdb2045dbfc3bb828bdc00c22ba94ac6ed0de7350b06179f3b9e27a6f5f5962ba0d56688195f313f319442826a1f05a47d32884e71a7c12154911f2d6726fb3f6847b7ce8a5b255b6cf4071d34dacfc1f38e6f9d2ad5f05c937a28941cac103212f64752a05712f1f50a5534e49ee8eb0f415e96f380bfd0ea06d62f38f23df868fa1b5352912edff36695d81df447f7a08ac9e268468825b34ffcc8187aec85e323ef8d0868506b73702acf666d6790efac698d7a10fd764df3a23ac4216c777f8334bf07d918e03419572e7135381a4aee0e334d2d265907efab86d4e281d839a1591cf85ac7f9128aacd5e182cb7431f913d7bc95cbc0384c6e4c93c9fcf0508e2d361859930446de4cec8eb859907eb527ad2c5567f2dea2be3b7aac46a1bd47e39afe1badc108cef16274f61cb975e1e4973f595092bf00c80dddc32986c105620ed7d3c39ca0c3ab735825a4593a12d54b8c980352a7d1e1b0c814e70f31da0cc0c53e308d2f1cfd85ed4c6c587361f8bac273af6955f9d69f4cb3567e062dc055f86188c43e31e3afcc200ac12c919e534ed137c5d3e5c84ec38657530b606eb3409685283fa0e7a85a5f4fcdf60bba2665e98677b60ff1c87407f506725763b1de048901bea92a0a77f084405800d8f65088c06f2169bcbc2003dfeadda53c3a7df7c841b7296200792ea7f1475d6b6c6ed93a2a61ad46bd127e3be3bf7135b8be0522c4e037ca6839be923a3dedce1a1ac3e14c03fb183dc23b8ff92a87b0d2bbef05f6a4ba54463c727cf869209b4fbd531d3d5c1fcdbf05df09d5cf42084b8889b0e927058af723e0dd0b8f95e4f985adf02f5f97f250d5d653aa8cb45a7f2a69bb26dd98ab945b96a7404b7f9764a02d969bb8ce79d3ddab37c044313c14d110a1ce298c8668c1813839e091ce404c7c5e98c642b0697e641e0d4f23cccc447baa6af75d56bef0b3f96b339f2aab7df28800e194ea4fb8d5e6aac9e62f0638b428caf4160a74b19d2c4fd6ff6b15138d8c44ae9df2bfb5aac3bf796e3826b525570b42bb9607fadefe49b4dad0b75f4aeb934ccf27c20f3ce9d983fb9105e78e432c375d57b86b718578121b90790610bc39d04a59a270a2c38c4de36ded4a1e76372c1813521ad745f3a4e6d85128de78dfb2b515d6a900162d94e71dd463bf23ee68b281b3dbaf9b32aee57b000ecc61e9534712057d7b6dfe8a1e2cac7e6d4d3c0a9987e46fd4ef3df0b30e85a059a6e86edfb87817b2f8b7fd244690be5045e9e41883291dd32db4605a023fcc9769f533339fb3c8f11919699c94feeaa05435f17a144d5a03374dae25882c23a84e40d7dd64e85d1fdac55fd8631f28482d6c694669de716e4b055f1ee01bf1e884e18f56d0153685e40443efaa471487d1a273614fe98ec6ee17cba39c733b8be9b0390c81f28cf6fb1996f8181aff153b89ee956f3cf7c4050b1d05ac3e26d21155ef087797fd5f6a3a62238dbd988fec00f88e4941e642070beea350d2aded80db022175161478989363212a402069aea9eefc41fcbf5ef4d9b8c4d8d1705b77a4c6776934f603c85334d6d5e1e4fd80474aa9a539688e9ce419987f35db02a99a06ed405e767ba678148af2fee782697c43228bf9548ca54821f5310faecac1220c8f3bd3b206bd9db1ecf29f3b2e51f1bbeac48b77ae65f306abed0e8f1e6492011e73eb4fd60b2e57d9f623e02be8c0c6c48921bb135d080d92e0a93ac43d4383df22864ed06ccb390ea651b25338215526fe3d2b5db31ec595cefd6d0239b23a685457fa0149f2a91867f6869f2977d8eb21df3c175d2d3c1fb9bc7b9a5ba313fc2d8e6b4faf1fdf2c988bfc970de1a6a472ea3866d100788775766e45a8c3e68b703b517c6ae7452e4a2f99365d70e125442032e99dc9ee214ea01a33772965864115f43bb8a62fc5e213c2e64d960087fd858beed02a70cb24cc7c7a05d8bee71fa5308a348a3a2ecb69d54567a6f5b6b02decb16fc6433fddf73477b4479fe96716fb08ba1d28cd23e3af4c1e2b04cb12b4473b194a18a1f4b1f3025921f1b4803129c6e833de307600586af23f7067ec2500617f25458fb10d6f440ba40cd9e88fb411b1b571db4665c107119b8cc5e2d7fa01e808ea19637b9cf07cb67e2b35a2b6fe731d96f874a8b81105a04aefbea0210818bacd56c21ec3a35f178e6936db01ffb7be1336a13039b34658a838de0ceb3b363eed473475b795daeac39ec3e706e9bfc2e7aef2ce9c5694a3012cbfebd697734c4252d5148663c66d39e54a87d1ed01dd784e8c8a335bef5be970de6e3ace1941ecbf162ae466208027931f9c2c2c5e0ee2fda11b7d61a7d00f726e695699724ceb1b6df49b150c5728cae48270577e53b177b784dc18bacb19cc88c73c0099d16c17b9c37299901c3c7b762ac3f5eb7409c154a1602dbfd30932e61c3d5a0dcfbb2012db302ea54c4dd17e96eba7164eaeaa9888b0db0befc9cb6e958c7cf564b3da8c46d673d1b2a69b7551f6bb17c4e6f89b42ffa5be958f91a881d49569ea079c2457b78fbdc10964f8cafbf7d2eacdcdebde36fc4a398fdf4369c7860460c4baa4f513a985685c86e537ab0435f1625462b7b6c3746f6356942e257b5c40f78a13cb696d3f458f9dd19b373bf3ef31d606ab4231bb19548adbf7f13b35084cc5f6eefe477401181b8eb94f95300140b8d19dbfae292dc1ab20cf3eaec31376dd0baf80a9019668cfaafb6d02bf61d76d24ae3fa68fca388ae94d440cb524d8cec6e4d912457f87422973f98689eac19c80f9bd300898d881d181c4f08932a175f5c175edb63944fcb721d92d9fd2bc2d53a1c9a7bf51265833607d1603674e92b46813f5e85ab7e488ae59d92be6feb1bd3290a4e731ba6ef49c417a47d88ce357a4822d9ff4890e649070328411aa132b4aeba24cbd268c379d3567442e2c1a2fa8235ac6ad03289e9dcc032e22984618acc531b769353d3ee05d75856894997a454ef03bf5c82bd2e46a93172cef6fd37ac4d54b7bcf0c492eac7c8445673e7ffcb7ac02ac899a863d0b01b2452dd343412c1c2827cc726683da284dfc17a9003a5387b925ada340c1041fd49e67860d51c4ec7b79f798b2f1d88b0ef8b03dd5672fbb881e55741ee7cf057299d9c1b9e46243cec123ccf4905d65977860f026abbb9fe6bd9063a3b5ffde21789ab6f31b39599643a8e50b47368a34333df74f4d0c237d93bbb296270ba5ea9f049779793d4932b7ef5a6b70d0f11eb7cb29eefa49d895f01e453f86fe3d01359c9cd311d4b4e31fc691f2b3e2ba9f2b6357e084f01c81afb25a02d377a5b4ce9427e7e68c3afaceeddfffac4cf4eb4b70b7520af921770d2a540627a8e068977514e86ec21b4201947631820c461ea74bb1839b76b0e61cc2b0bddb237cea9d54c207998c0702c6821b1617d415141c57cfd68bb74bfa18bc84ace069500e7c5ba976ede1635639b6879290251d244b2df0dc23f47f5656d9456f33ba93a2f1bfac81eef25f019714927b2397ba19e00f44279de9da757f5dcf0887232a8af449c4e82131a1a916b264af5b339a207990bf9fd121f06b5b7e8863da73bab975b48a1b7a4fa0929be6971143644845287677f22392129df98bc6d6fcc71bc120f0ed9c0a4ee0e01832fef2913c20d56c4c3cd75c73e23fe3a44c6a1b6079d285e8ce3697db7d0c0f8598d3e39e5997e6ea9a1bbb7bd3e066be6825cffb84035833dd1196796a1005416e021c0b954effff5bdc74325d52a11d58fda260a3fd0706762ee6096cb809b810629b27a8b743de02dd65013f1a972c82724adb065de1ad248d60fc11798b4c2604e5236cea798ed397355ce5d6210e6e23f80e0f0476b4e357f00b76f0279aec33a557b4dc4eed37575c29a94705b3d8622d294ffee9fcbd304200900828f599b02e2c3a671144075eb019861eb2a7c483bcfbdd0e70a9db07123618445271aab3d8f61118a3e63a70b8bdcee0f746e2eef80000000000000000000000000000000000000000000000000004070f131a1e"

const isValid = ml_dsa65.verify(
    hexConvert(_publicKey), 
    hexConvert(_msg), 
    hexConvert(_sig)
);

var response = 0

if (isValid) {
    response = 1
}

return Functions.encodeUint256(response);


   //credit : https://stackoverflow.com/questions/43131242/how-to-convert-a-hexadecimal-string-of-data-to-an-arraybuffer-in-javascript
function hexConvert(hex) {
    var typedArray = new Uint8Array(hex.match(/[\da-f]{2}/gi).map(function (h) {
      return parseInt(h, 16)
    }))
  
    return typedArray
  }
